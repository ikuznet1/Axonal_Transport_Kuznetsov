function error = funerr5_6_boot_anal_hpc(para)

global Dfree L T12 va vr gamma10 gamma01 gammaona gammaoffr jtot0 nfree0 ...
    A5 xx12 yy12 eps ntotvect
    
% Problem parameter, shared with nested functions

L = 600; va = 0.5; vr = 0.5; 

%gamma10 = 0.093; gamma01 = 0.041;
gamma10 = para(1); gamma01 = para(2);

%gammaar = 3.1*0.00001; gammara = 6.9*0.00001; 
gammaar = 0; gammara = 0;
 
%gammaona = 2.75*0.0001; gammaonr = 2.75*0.0001;
gammaona=para(3); gammaonr=0;

%gammaoffa = 0.001*4.45*0.001;gammaoffr = 0.001*4.45*0.001;
gammaoffa = 0; gammaoffr = para(4);

%Dfree = 3; T12 =2.16*100000;
Dfree=0.5; T12 = 5.01e5;

%jtot0=0.1; nfree0=0.5;
jtot0=para(5); nfree0=para(6);  A5=para(7);

%x0 = [2.53631e-18, 6.20609e-07, 6.69031e-01, 8.40849e-02];
x0 = [8.06584e-02, 2.24144e-19, 7.17027e-01, 1.12410e-01];
fun = @analyt_bc_boot;
[cvect,fval15,exitflag,output] = fsolve(fun,x0);

C1=cvect(1); C2=cvect(2); C3=cvect(3); C4=cvect(4);
%sprintf('%0.5e %0.5e %0.5e %0.5e',C1,C2,C3,C4)

nr=@(x) C1.*exp(1).^(gamma10.*gammaoffr.*(gamma01+gammaoffr).^(-1).* ...
  vr.^(-1).*x);

nfree=@(x) (1/2).*exp(1).^((-1).*x.*(Dfree.*T12.*(gammaona.*T12+log(2)) ...
  .^(-1)).^(-1/2)).*((-1).*Dfree.*gamma10.^2.*gammaoffr.^2.* ...
  T12+(gamma01+gammaoffr).^2.*vr.^2.*(gammaona.*T12+log(2))) ...
  .^(-1).*(2.*C1.*exp(1).^(x.*(gamma10.*gammaoffr.*(gamma01+ ...
  gammaoffr).^(-1).*vr.^(-1)+(Dfree.^(-1).*T12.^(-1).*( ...
  gammaona.*T12+log(2))).^(1/2))).*gamma10.*gammaoffr.*( ...
  gamma01+gammaoffr).*T12.*vr.^2+(-1).*(C3+C2.*exp(1).^(2.*x.* ...
  (Dfree.^(-1).*T12.^(-1).*(gammaona.*T12+log(2))).^(1/2))).*( ...
  2.*Dfree.*gamma10.^2.*gammaoffr.^2.*T12+(-2).*(gamma01+ ...
  gammaoffr).^2.*vr.^2.*(gammaona.*T12+log(2))));

nfreedir=@(x) (1/2).*exp(1).^((-1).*x.*(Dfree.*T12.*(gammaona.*T12+log(2)) ...
  .^(-1)).^(-1/2)).*((-1).*Dfree.*gamma10.^2.*gammaoffr.^2.* ...
  T12+(gamma01+gammaoffr).^2.*vr.^2.*(gammaona.*T12+log(2))) ...
  .^(-1).*(2.*C1.*exp(1).^(x.*(gamma10.*gammaoffr.*(gamma01+ ...
  gammaoffr).^(-1).*vr.^(-1)+(Dfree.^(-1).*T12.^(-1).*( ...
  gammaona.*T12+log(2))).^(1/2))).*gamma10.*gammaoffr.*T12.* ...
  vr.*(gamma10.*gammaoffr+(-1).*(gamma01+gammaoffr).*vr.*( ...
  Dfree.*T12.*(gammaona.*T12+log(2)).^(-1)).^(-1/2)+gamma01.* ...
  vr.*(Dfree.^(-1).*T12.^(-1).*(gammaona.*T12+log(2))).^(1/2)+ ...
  gammaoffr.*vr.*(Dfree.^(-1).*T12.^(-1).*(gammaona.*T12+log( ...
  2))).^(1/2))+2.*(Dfree.*T12.*(gammaona.*T12+log(2)).^(-1)) ...
  .^(-1/2).*(Dfree.*gamma10.^2.*gammaoffr.^2.*T12+(-1).*( ...
  gamma01+gammaoffr).^2.*vr.^2.*(gammaona.*T12+log(2))).*(C3+( ...
  -1).*C2.*exp(1).^(2.*x.*(Dfree.^(-1).*T12.^(-1).*(gammaona.* ...
  T12+log(2))).^(1/2)).*((-1)+2.*(Dfree.*T12.*(gammaona.*T12+ ...
  log(2)).^(-1)).^(1/2).*(Dfree.^(-1).*T12.^(-1).*(gammaona.* ...
  T12+log(2))).^(1/2))));

na=@(x) C4+exp(1).^((-1).*x.*(Dfree.*T12.*(gammaona.*T12+log(2)).^( ...
  -1)).^(-1/2)).*gammaona.*va.^(-1).*(Dfree.*gamma10.^2.* ...
  gammaoffr.^2.*T12+(-1).*(gamma01+gammaoffr).^2.*vr.^2.*( ...
  gammaona.*T12+log(2))).^(-1).*((-1).*C1.*exp(1).^(x.*( ...
  gamma10.*gammaoffr.*(gamma01+gammaoffr).^(-1).*vr.^(-1)+( ...
  Dfree.^(-1).*T12.^(-1).*(gammaona.*T12+log(2))).^(1/2))).*( ...
  gamma01+gammaoffr).^2.*T12.*vr.^3+(C3+(-1).*C2.*exp(1).^(2.* ...
  x.*(Dfree.*T12.*(gammaona.*T12+log(2)).^(-1)).^(-1/2))).*( ...
  Dfree.*T12.*(gammaona.*T12+log(2)).^(-1)).^(1/2).*((-1).* ...
  Dfree.*gamma10.^2.*gammaoffr.^2.*T12+(gamma01+gammaoffr) ...
  .^2.*vr.^2.*(gammaona.*T12+log(2))));

na0=@(x) gamma01.^(-1).*gammaona.*nfree(x)+gamma01.^(-1).*gamma10.*na(x);

nr0=@(x) gamma10.*(gamma01+gammaoffr).^(-1).*nr(x);

ntot=@(x) na(x)+nr(x)+na0(x)+nr0(x)+nfree(x);
jtot=@(x) -Dfree*nfreedir(x)+va*na(x)-vr.*nr(x);
vv=@(x) jtot(x)./ntot(x);

ntot=@(x) na(x)+nr(x)+na0(x)+nr0(x)+nfree(x);
jtot=@(x) -Dfree*nfreedir(x)+va*na(x)-vr.*nr(x);
vv=@(x) jtot(x)./ntot(x);

nmt=@(x) na(x)+nr(x)+na0(x)+nr0(x);
nmtproc=@(x) 100*nmt(x)./ntot(x);


xx11=xx12;

ntotp=ntot(xx11); vvp=vv(xx11);
nmtprocp=nmtproc(xx11(38));

%dev1=100*(ntotp(1)-yy12(1))^2+100*(ntotp(13)-yy12(13))^2;
dev1=0;
for i=1:76
    dev1=dev1+(ntotp(i)-yy12(i))^2;
end

for i=1:76
eps(i)=yy12(i)-ntotp(i);
ntotvect(i)=ntotp(i);
end

dev2=0;
for i=1:76
dev2=dev2+(vvp(i)-0.0926)^2;
end

dev3=(nmtprocp-100)^2;

error=dev1+10*dev2+10*dev3;

